<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>How to Get Loans Funded on Kiva.org by mattlichti</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">How to Get Loans Funded on Kiva.org</h1>
      <h2 class="project-tagline">Analysis of the features that predict fundraising success</h2>
      <a href="https://github.com/mattlichti/kiva-fundraising-success" class="btn">View on GitHub</a>
      <a href="https://github.com/mattlichti/kiva-fundraising-success/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/mattlichti/kiva-fundraising-success/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="how-to-get-loans-funded-on-kiva" class="anchor" href="#how-to-get-loans-funded-on-kiva" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to get Loans Funded on Kiva</h1>

<h3>
<a id="motivation" class="anchor" href="#motivation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation:</h3>

<p>This project is an analysis of what features make microfinance loans on <a href="kiva.org">kiva.org</a> more likely to get funded. There are over 2 million small time lenders on kiva who have funded over 880,000 microfinance loans totaling $712 million since 2005. The loans are originally made by 296 different microfinance organizations in 85 countries who use kiva to raise money to backfill some of their loans. Lenders can view the loans on the website and lend as little as $25 to any of the borrowers they chose.</p>

<p>Since January 2012, kiva has usually had a 30 day expiration policy. If a loan is not fully funded in that time, the lenders are refunded and the microfinance organization does not receive any money. This is similar to the funding model used on kickstarter where projects do not receive any money unless they are fully funded. Because of the risk of loan expiration, it is important for the microfinance organizations to understand the characteristics that make loans more likely to get funded. The analysis could also help kiva.org increase the total number of loans getting funded, which would help more struggling entrepreneurs around the globe get the capital they need to build their businesses.</p>

<h3>
<a id="data" class="anchor" href="#data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data:</h3>

<p>Kiva makes their loan data available through their <a href="http://build.kiva.org/">api</a>. They also periodically make <a href="http://build.kiva.org/docs/data/snapshots">downloadable snapshots</a> of the data. I most recently used the May 18 2015 json snapshot for this analysis. The loan data is in a 1 GB zip file that is 5 GB when unzipped. </p>

<h3>
<a id="pipeline" class="anchor" href="#pipeline" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pipeline:</h3>

<p>The <a href="https://github.com/mattlichti/kiva-fundraising-success/blob/master/data_pipeline.py">data_pipeline.py</a> file is used for processing the raw kiva loan data. It extracts the relevant data, performs the feature engineering, and then stores it all in a postgres SQL database. To run the pipeline, unzip the loans folder containing around 1800 json files that each have the data from 500 loans. Then setup a postgres database and run pipeline.py in the terminal the loans folder location and sql information as command line arguments. </p>

<p>The most important part of the process is feature engineering. The features include anything that a potential borrower sees when viewing a loan on kiva org that they can use to decide whether or not to loan to a particular individual. A typical view of a loan from the kiva website is pictured below with some of the important features highlighted.</p>

<p><img src="https://github.com/mattlichti/kiva-fundraising-success/blob/master/img/feature_engineering.jpg?raw=true" alt="Feature Engineering"></p>

<p>The features include the loan amount, repayment term (anywhere from 4 months to several years), gender, group size (loans can be for 1 person or a group of people), whether the borrower is liable for losses due to currency fluctuations, whether the borrower has their name and photo on the website rather than remain anonymous. Categorical variables include country (currently 84 countries), sector (15 categories like transportation or agriculture), and a narrower activity category (150 categories like "rickshaw" or "cattle"). The loans also have various searchable themes like "green", "fair trade", "conflict zones", etc. I used the one sentence description of how the loan will be used to engineer features out of the most commonly used terms. The length of this text as well as the length of the larger description text were also useful features. </p>

<p>In addition to the features that impact demand for particular loans, the supply of loans on the site can impact the chances of each loan getting funded. I used SQL to calculate the number of other loans on kiva at the time each loan was posted by comparing the timestamp of when each loan was posted to the timestamps for when other loans were posted and funded or expired.</p>

<p><img src="https://github.com/mattlichti/kiva-fundraising-success/blob/master/plots/competing_loans.png?raw=true" alt="Competing Loans"></p>

<p>When there are few loans on the site, almost all of the loans get funded. When there is more competition, lenders have more options each loan has a higher chance of expiring. In the future, it might be useful to look at the total value of the loans currently fundraising and how far along they are in their fundraising, not just the number of loans. It might also be useful to look at attributes of those loans. For example, if there are a lot of loans currently fundraising from the same country or economic sector as the loan being posted, it may lower the chance of that loan getting funded.</p>

<h3>
<a id="modeling" class="anchor" href="#modeling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Modeling:</h3>

<p>build_model.py is used to train the model, predict which loans have a higher risk of expiring, and determine which features are most important in predicting loan success. run_model.py is used to load the relevant data from the postgres sql database and run the model on that data. It can be run from the command line like data_pipeline.py. </p>

<p>The model converts the categorical features into boolean dummy variables, and tokenizes, lemmatizes, and performs TF-IDF on the text. I used a random forest model which I had to tune quite a bit to avoid overfitting. The classes were unbalanced with a much higher number of funded loans than expired loans, so I heavily weighted the expired loans in order to increase recall of expired loans at the expense of precision. I also tried logistic regression and SVM but they have not performed quite as well. The model can output a confusion matrix and a list of feature importances which could be used as recommendations on how to improve their odds of getting their loans funded. </p>

<p>The plots.py file is used to make plots of some of the feture importances in the random forest model, as well as plot the expiration rate based on a variety of features and the expiration rate over time.</p>

<h3>
<a id="results" class="anchor" href="#results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results:</h3>

<p><img src="https://github.com/mattlichti/kiva-fundraising-success/blob/master/plots/feature_importance.png" alt="Feature Importance"></p>

<p>Lenders on kiva show a strong preference for loans with a schedule repayment term as well as loans to women. Loans for larger amounts of money are not surprisingly more difficult to fund since they require more lenders to fully fund. Lenders also prefer lending to certain countries, especially African countries and countries with fewer loans available on kiva. Loans to countries with lots of loans available like El Salvador (SV) and Colombia (CO) are at greater risk for loan expiration. Lenders also have strong preferences for different loan uses with loans for personal housing much more likely to expire than loans for education or starting a business.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/mattlichti/kiva-fundraising-success">How to Get Loans Funded on Kiva.org</a> is maintained by <a href="https://github.com/mattlichti">mattlichti</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

